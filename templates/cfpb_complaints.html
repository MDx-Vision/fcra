<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CFPB Complaints - FCRA Litigation Platform</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #f0f2f5;
            min-height: 100vh;
        }
        
        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            width: 260px;
            height: 100vh;
            background: linear-gradient(180deg, #1a1a2e 0%, #16213e 100%);
            padding: 20px;
            z-index: 100;
            overflow-y: auto;
        }
        
        .logo {
            display: flex;
            align-items: center;
            color: white;
            font-size: 20px;
            font-weight: 700;
            padding: 15px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            margin-bottom: 30px;
        }
        .logo img { height: 40px; margin-right: 10px; }
        .logo span { color: #84cc16; }
        
        .nav-section { margin-bottom: 25px; }
        .nav-section-title {
            color: #64748b;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 10px;
        }
        
        .nav-item {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            color: #94a3b8;
            text-decoration: none;
            border-radius: 8px;
            margin-bottom: 5px;
            transition: all 0.2s;
        }
        .nav-item:hover { background: rgba(255,255,255,0.1); color: white; }
        .nav-item.active { background: linear-gradient(135deg, #319795 0%, #84cc16 100%); color: #1a1a2e; font-weight: 600; }
        .nav-item svg { width: 20px; height: 20px; margin-right: 12px; }
        
        .main-content {
            margin-left: 260px;
            padding: 30px;
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }
        .header h1 {
            font-size: 28px;
            font-weight: 700;
            color: #1a1a2e;
        }
        .header-subtitle {
            color: #64748b;
            font-size: 14px;
            margin-top: 5px;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s;
            text-decoration: none;
        }
        .btn-primary {
            background: linear-gradient(135deg, #319795 0%, #84cc16 100%);
            color: #1a1a2e;
        }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(49, 151, 149, 0.4); }
        .btn-secondary {
            background: white;
            color: #1a1a2e;
            border: 2px solid #e2e8f0;
        }
        .btn-secondary:hover { border-color: #84cc16; }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
        }
        .stat-card.draft::before { background: #64748b; }
        .stat-card.ready::before { background: #3b82f6; }
        .stat-card.submitted::before { background: #22c55e; }
        .stat-card.response::before { background: #a855f7; }
        
        .stat-number {
            font-size: 36px;
            font-weight: 700;
            line-height: 1;
            margin-bottom: 8px;
            color: #1a1a2e;
        }
        .stat-label {
            font-size: 14px;
            color: #64748b;
            font-weight: 500;
        }
        
        .section {
            background: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #e2e8f0;
        }
        .section-title {
            font-size: 18px;
            font-weight: 600;
            color: #1a1a2e;
        }
        
        .complaint-table {
            width: 100%;
            border-collapse: collapse;
        }
        .complaint-table th,
        .complaint-table td {
            padding: 14px 12px;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }
        .complaint-table th {
            font-size: 12px;
            font-weight: 600;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .complaint-table tr:hover {
            background: #f8fafc;
        }
        
        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }
        .status-badge.draft { background: #e2e8f0; color: #475569; }
        .status-badge.ready { background: #dbeafe; color: #1d4ed8; }
        .status-badge.submitted { background: #dcfce7; color: #16a34a; }
        .status-badge.response_received { background: #f3e8ff; color: #9333ea; }
        
        .target-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
        }
        .target-badge.cra { background: #fef3c7; color: #b45309; }
        .target-badge.furnisher { background: #e0e7ff; color: #4338ca; }
        
        .action-btn {
            padding: 8px 14px;
            border: none;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            background: #e2e8f0;
            color: #475569;
            margin-right: 6px;
            text-decoration: none;
            transition: all 0.2s;
        }
        .action-btn:hover { background: #cbd5e1; }
        .action-btn.primary { background: #319795; color: white; }
        .action-btn.primary:hover { background: #2c7a7b; }
        
        .empty-state {
            text-align: center;
            padding: 60px 40px;
            color: #94a3b8;
        }
        .empty-state svg {
            width: 64px;
            height: 64px;
            margin-bottom: 20px;
            opacity: 0.5;
        }
        .empty-state h3 {
            font-size: 18px;
            color: #475569;
            margin-bottom: 10px;
        }
        .empty-state p {
            margin-bottom: 20px;
        }
        
        .info-box {
            background: #eff6ff;
            border: 1px solid #bfdbfe;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 30px;
        }
        .info-box-title {
            font-weight: 600;
            color: #1e40af;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .info-box-text {
            font-size: 13px;
            color: #1e40af;
            line-height: 1.6;
        }
        
        .filters {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        .filter-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 8px;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            background: #e2e8f0;
            color: #475569;
            transition: all 0.2s;
        }
        .filter-btn.active {
            background: linear-gradient(135deg, #319795 0%, #84cc16 100%);
            color: #1a1a2e;
        }
        .filter-btn:hover:not(.active) {
            background: #cbd5e1;
        }
    </style>
</head>
<body>
    <nav class="sidebar">
        <div class="logo">
            <img src="/static/images/logo.png" alt="Brightpath Ascend">
            <span>Brightpath Ascend</span>
        </div>
        
        <div class="nav-section">
            <div class="nav-section-title">Main</div>
            <a href="/dashboard" class="nav-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg>
                Dashboard
            </a>
            <a href="/dashboard/clients" class="nav-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
                Clients
            </a>
        </div>
        
        <div class="nav-section">
            <div class="nav-section-title">Regulatory</div>
            <a href="/dashboard/cfpb" class="nav-item active">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/></svg>
                CFPB Complaints
            </a>
            <a href="/dashboard/sol" class="nav-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
                SOL Tracker
            </a>
        </div>
        
        <div class="nav-section">
            <div class="nav-section-title">Cases</div>
            <a href="/dashboard/settlements" class="nav-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
                Settlements
            </a>
            <a href="/dashboard/furnishers" class="nav-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 21V5a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v5m-4 0h4"/></svg>
                Furnisher Intelligence
            </a>
        </div>
    </nav>
    
    <main class="main-content">
        <div class="header">
            <div>
                <h1>CFPB Complaint Generator</h1>
                <p class="header-subtitle">File complaints with the Consumer Financial Protection Bureau</p>
            </div>
            <a href="/dashboard/cfpb/generator" class="btn btn-primary">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
                New Complaint
            </a>
        </div>
        
        <div class="info-box">
            <div class="info-box-title">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></svg>
                About CFPB Complaints
            </div>
            <div class="info-box-text">
                CFPB complaints are a powerful tool for consumers. The Bureau forwards complaints to companies for response within 15 days.
                Companies are required to respond, and complaints become part of the public record. Use this tool to generate professional
                CFPB complaints with AI-powered narratives based on identified FCRA violations.
            </div>
        </div>
        
        <div class="stats-grid">
            <div class="stat-card draft">
                <div class="stat-number">{{ stats.draft }}</div>
                <div class="stat-label">Draft Complaints</div>
            </div>
            <div class="stat-card ready">
                <div class="stat-number">{{ stats.ready }}</div>
                <div class="stat-label">Ready to Submit</div>
            </div>
            <div class="stat-card submitted">
                <div class="stat-number">{{ stats.submitted }}</div>
                <div class="stat-label">Submitted</div>
            </div>
            <div class="stat-card response">
                <div class="stat-number">{{ stats.response_received }}</div>
                <div class="stat-label">Response Received</div>
            </div>
        </div>
        
        <div class="section">
            <div class="section-header">
                <div class="section-title">All Complaints ({{ stats.total }})</div>
            </div>
            
            <div class="filters">
                <button class="filter-btn active" onclick="filterComplaints('all')">All</button>
                <button class="filter-btn" onclick="filterComplaints('draft')">Draft</button>
                <button class="filter-btn" onclick="filterComplaints('ready')">Ready</button>
                <button class="filter-btn" onclick="filterComplaints('submitted')">Submitted</button>
                <button class="filter-btn" onclick="filterComplaints('response_received')">Response Received</button>
            </div>
            
            {% if complaints %}
            <table class="complaint-table">
                <thead>
                    <tr>
                        <th>Client</th>
                        <th>Target</th>
                        <th>Issue Type</th>
                        <th>Status</th>
                        <th>CFPB ID</th>
                        <th>Created</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="complaintsTableBody">
                    {% for c in complaints %}
                    <tr class="complaint-row" data-status="{{ c.status }}">
                        <td>
                            <div style="font-weight: 600; color: #1a1a2e;">{{ c.client_name }}</div>
                        </td>
                        <td>
                            <span class="target-badge {{ c.target_type }}">{{ c.target_type }}</span>
                            <div style="font-size: 12px; color: #64748b; margin-top: 4px;">{{ c.target_company }}</div>
                        </td>
                        <td style="font-size: 13px; max-width: 200px;">{{ c.issue_type }}</td>
                        <td>
                            <span class="status-badge {{ c.status }}">{{ c.status.replace('_', ' ').title() }}</span>
                        </td>
                        <td style="font-size: 13px; color: #64748b;">{{ c.cfpb_complaint_id or '-' }}</td>
                        <td style="font-size: 13px; color: #64748b;">{{ c.created_at.strftime('%m/%d/%Y') }}</td>
                        <td>
                            <a href="/dashboard/cfpb/complaint/{{ c.id }}" class="action-btn primary">View</a>
                            {% if c.file_path %}
                            <a href="/{{ c.file_path }}" target="_blank" class="action-btn">PDF</a>
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% else %}
            <div class="empty-state">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                    <polyline points="14 2 14 8 20 8"/>
                    <line x1="16" y1="13" x2="8" y2="13"/>
                    <line x1="16" y1="17" x2="8" y2="17"/>
                </svg>
                <h3>No CFPB Complaints Yet</h3>
                <p>Start by creating a new complaint for a client with identified FCRA violations.</p>
                <a href="/dashboard/cfpb/generator" class="btn btn-primary">Create First Complaint</a>
            </div>
            {% endif %}
        </div>
    </main>
    
    <script>
        function filterComplaints(status) {
            const rows = document.querySelectorAll('.complaint-row');
            const buttons = document.querySelectorAll('.filter-btn');
            
            buttons.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            rows.forEach(row => {
                if (status === 'all' || row.dataset.status === status) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });
        }
    </script>
</body>
</html>
