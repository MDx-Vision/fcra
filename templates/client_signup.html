<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Start Your Credit Journey - Brightpath Ascend Group</title>
    <link rel="icon" type="image/x-icon" href="/static/favicon.ico">
    <link rel="apple-touch-icon" href="/static/apple-touch-icon.png">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
        }
        .header {
            background: rgba(255,255,255,0.05);
            backdrop-filter: blur(10px);
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .logo {
            display: flex;
            align-items: center;
            color: white;
            font-size: 20px;
            font-weight: 700;
        }
        .logo img { height: 45px; margin-right: 12px; background: transparent; }
        .logo span { color: #84cc16; font-weight: 600; }
        .header-links a {
            color: rgba(255,255,255,0.7);
            text-decoration: none;
            margin-left: 25px;
            font-size: 14px;
            transition: color 0.3s;
        }
        .header-links a:hover { color: white; }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            align-items: start;
        }
        .sample-section {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        .sample-card {
            background: rgba(255,255,255,0.08);
            border: 1px solid rgba(132, 204, 22, 0.3);
            border-radius: 15px;
            padding: 25px;
            backdrop-filter: blur(10px);
        }
        .sample-title {
            color: #84cc16;
            font-size: 14px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 15px;
        }
        .violation-item {
            background: rgba(239, 68, 68, 0.1);
            border-left: 4px solid #ef4444;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 12px;
        }
        .violation-item .violation-type {
            color: #fca5a5;
            font-size: 12px;
            font-weight: 700;
            text-transform: uppercase;
            margin-bottom: 5px;
        }
        .violation-item .violation-desc {
            color: rgba(255,255,255,0.7);
            font-size: 14px;
        }
        .damages-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-top: 15px;
        }
        .damage-box {
            background: rgba(84, 82, 255, 0.1);
            border: 1px solid rgba(84, 82, 255, 0.3);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }
        .damage-label {
            color: rgba(255,255,255,0.6);
            font-size: 11px;
            text-transform: uppercase;
            margin-bottom: 8px;
        }
        .damage-amount {
            color: #60a5fa;
            font-size: 24px;
            font-weight: 700;
        }
        .estimate-box {
            background: linear-gradient(135deg, rgba(132, 204, 22, 0.15) 0%, rgba(84, 82, 255, 0.15) 100%);
            border: 2px solid rgba(132, 204, 22, 0.3);
            border-radius: 12px;
            padding: 25px;
            text-align: center;
        }
        .estimate-label {
            color: rgba(255,255,255,0.7);
            font-size: 14px;
            margin-bottom: 10px;
        }
        .estimate-amount {
            color: #84cc16;
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 8px;
            font-family: 'Courier New', monospace;
        }
        .estimate-note {
            color: rgba(255,255,255,0.5);
            font-size: 12px;
        }
        @media (max-width: 1024px) {
            .container {
                grid-template-columns: 1fr;
                gap: 30px;
            }
            .sample-section {
                display: none;
            }
        }
        .hero {
            text-align: center;
            color: white;
            margin-bottom: 40px;
        }
        .hero h1 {
            font-size: 36px;
            margin-bottom: 15px;
            background: linear-gradient(135deg, #319795 0%, #84cc16 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .hero p {
            color: rgba(255,255,255,0.7);
            font-size: 16px;
            max-width: 500px;
            margin: 0 auto;
        }
        .progress-bar {
            display: flex;
            justify-content: center;
            margin-bottom: 40px;
            gap: 30px;
        }
        .progress-step {
            display: flex;
            align-items: center;
            gap: 10px;
            color: rgba(255,255,255,0.4);
        }
        .progress-step.active { color: #84cc16; }
        .progress-step.completed { color: #84cc16; }
        .step-number {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            border: 2px solid currentColor;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: 600;
        }
        .progress-step.completed .step-number {
            background: #84cc16;
            border-color: #84cc16;
            color: #1a1a2e;
        }
        .progress-step.active .step-number {
            background: rgba(132, 204, 22, 0.2);
        }
        .form-card {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        .form-section {
            display: none;
        }
        .form-section.active {
            display: block;
        }
        .section-title {
            font-size: 20px;
            font-weight: 600;
            color: #1a1a2e;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid #e5e7eb;
        }
        .form-row {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 20px;
        }
        .form-row.single {
            grid-template-columns: 1fr;
        }
        .form-group {
            margin-bottom: 20px;
        }
        .form-group label {
            display: block;
            font-size: 13px;
            font-weight: 600;
            color: #374151;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .form-group label .required {
            color: #ef4444;
            margin-left: 2px;
        }
        .form-group input,
        .form-group select {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            font-size: 15px;
            transition: all 0.3s;
            background: #f9fafb;
        }
        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #84cc16;
            background: white;
            box-shadow: 0 0 0 3px rgba(132, 204, 22, 0.1);
        }
        .form-group input.error {
            border-color: #ef4444;
        }
        .form-group .error-message {
            color: #ef4444;
            font-size: 12px;
            margin-top: 5px;
            display: none;
        }
        .form-group input.error + .error-message {
            display: block;
        }
        .form-group .help-text {
            color: #6b7280;
            font-size: 12px;
            margin-top: 5px;
        }
        .credit-service-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
            margin-bottom: 25px;
        }
        .credit-service-option {
            padding: 20px 15px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        .credit-service-option:hover {
            border-color: #84cc16;
            background: rgba(132, 204, 22, 0.05);
        }
        .credit-service-option.selected {
            border-color: #84cc16;
            background: rgba(132, 204, 22, 0.1);
        }
        .credit-service-option input {
            display: none;
        }
        .credit-service-option .service-name {
            font-weight: 600;
            color: #1a1a2e;
            font-size: 13px;
        }
        .agreement-section {
            background: #f9fafb;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
        }
        .agreement-section h3 {
            font-size: 16px;
            color: #1a1a2e;
            margin-bottom: 15px;
        }
        .agreement-text {
            max-height: 200px;
            overflow-y: auto;
            padding: 15px;
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            font-size: 13px;
            color: #6b7280;
            line-height: 1.6;
            margin-bottom: 15px;
        }
        .checkbox-group {
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }
        .checkbox-group input[type="checkbox"] {
            width: 20px;
            height: 20px;
            margin-top: 2px;
            accent-color: #84cc16;
        }
        .checkbox-group label {
            font-size: 14px;
            color: #374151;
            cursor: pointer;
        }
        .button-row {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            gap: 15px;
        }
        .btn {
            padding: 14px 30px;
            border-radius: 10px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            border: none;
        }
        .btn-secondary {
            background: #f3f4f6;
            color: #374151;
        }
        .btn-secondary:hover {
            background: #e5e7eb;
        }
        .btn-primary {
            background: linear-gradient(135deg, #319795 0%, #84cc16 100%);
            color: #1a1a2e;
            flex: 1;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(49, 151, 149, 0.4);
        }
        .btn-primary:disabled {
            background: #d1d5db;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        .success-message {
            display: none;
            text-align: center;
            padding: 60px 40px;
        }
        .success-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #319795 0%, #84cc16 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 25px;
        }
        .success-icon svg {
            width: 40px;
            height: 40px;
            color: white;
        }
        .success-message h2 {
            font-size: 28px;
            color: #1a1a2e;
            margin-bottom: 15px;
        }
        .success-message p {
            color: #6b7280;
            font-size: 16px;
            margin-bottom: 30px;
        }
        .referral-code {
            background: #f9fafb;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 25px;
        }
        .referral-code label {
            font-size: 12px;
            color: #6b7280;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .referral-code .code {
            font-size: 24px;
            font-weight: 700;
            color: #84cc16;
            font-family: monospace;
        }
        .loading-spinner {
            display: none;
            width: 20px;
            height: 20px;
            border: 2px solid transparent;
            border-top-color: currentColor;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
            margin-right: 10px;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .pricing-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }
        .pricing-option {
            position: relative;
            padding: 25px 20px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            background: white;
        }
        .pricing-option:hover {
            border-color: #84cc16;
            background: rgba(132, 204, 22, 0.05);
            transform: translateY(-3px);
        }
        .pricing-option.selected {
            border-color: #84cc16;
            background: rgba(132, 204, 22, 0.1);
            box-shadow: 0 4px 15px rgba(132, 204, 22, 0.2);
        }
        .pricing-option input {
            display: none;
        }
        .pricing-option.popular {
            border-color: #84cc16;
        }
        .popular-badge {
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #319795 0%, #84cc16 100%);
            color: white;
            font-size: 11px;
            font-weight: 600;
            padding: 4px 12px;
            border-radius: 20px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .plan-header {
            margin-bottom: 10px;
        }
        .plan-name {
            display: block;
            font-weight: 600;
            color: #1a1a2e;
            font-size: 16px;
            margin-bottom: 5px;
        }
        .plan-price {
            display: block;
            font-size: 28px;
            font-weight: 700;
            color: #84cc16;
        }
        .plan-desc {
            font-size: 13px;
            color: #6b7280;
            line-height: 1.4;
            margin: 0;
        }
        .plan-features {
            background: #f9fafb;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
        }
        .plan-features h4 {
            font-size: 14px;
            color: #1a1a2e;
            margin-bottom: 12px;
        }
        .plan-features ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .plan-features li {
            font-size: 13px;
            color: #6b7280;
            padding: 6px 0 6px 22px;
            position: relative;
        }
        .plan-features li:before {
            content: '\2713';
            position: absolute;
            left: 0;
            color: #84cc16;
            font-weight: bold;
        }
        .pricing-option.free-tier {
            background: linear-gradient(135deg, rgba(49, 151, 149, 0.1) 0%, rgba(132, 204, 22, 0.1) 100%);
            border-color: #84cc16;
        }
        .pricing-option.free-tier .plan-price {
            color: #84cc16;
        }
        .payment-methods {
            margin-top: 30px;
            padding-top: 25px;
            border-top: 1px solid #e5e7eb;
        }
        .payment-methods-title {
            font-size: 16px;
            font-weight: 600;
            color: #1a1a2e;
            margin-bottom: 15px;
        }
        .payment-methods-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 12px;
        }
        .payment-option {
            padding: 15px 12px;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            background: white;
        }
        .payment-option:hover {
            border-color: #84cc16;
            background: rgba(132, 204, 22, 0.05);
        }
        .payment-option.selected {
            border-color: #84cc16;
            background: rgba(132, 204, 22, 0.1);
        }
        .payment-option input {
            display: none;
        }
        .payment-option .payment-icon {
            font-size: 24px;
            margin-bottom: 6px;
        }
        .payment-option .payment-name {
            font-size: 12px;
            font-weight: 600;
            color: #374151;
        }
        .manual-payment-info {
            display: none;
            background: #f0fdf4;
            border: 2px solid #84cc16;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
            text-align: center;
        }
        .manual-payment-info.active {
            display: block;
        }
        .manual-payment-info h4 {
            font-size: 16px;
            color: #1a1a2e;
            margin-bottom: 10px;
        }
        .manual-payment-info .payment-handle {
            font-size: 24px;
            font-weight: 700;
            color: #84cc16;
            font-family: monospace;
            margin-bottom: 10px;
        }
        .manual-payment-info p {
            font-size: 13px;
            color: #6b7280;
        }
        .pay-later-info {
            display: none;
            background: #fef3c7;
            border: 2px solid #f59e0b;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
            text-align: center;
        }
        .pay-later-info.active {
            display: block;
        }
        .pay-later-info h4 {
            color: #92400e;
        }
        @media (max-width: 768px) {
            .form-row { grid-template-columns: 1fr; }
            .credit-service-grid { grid-template-columns: repeat(2, 1fr); }
            .pricing-grid { grid-template-columns: 1fr; }
            .progress-bar { flex-wrap: wrap; gap: 15px; }
            .form-card { padding: 25px; }
            .hero h1 { font-size: 28px; }
            .container { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="logo"><img src="/static/images/logo.png" alt="Brightpath Ascend Group"><span>Brightpath Ascend Group</span></div>
        <div class="header-links">
            <a href="/">Home</a>
            <a href="/portal/login">Client Login</a>
            <a href="tel:9179094051">Call Us</a>
        </div>
    </header>
    
    <div class="container" style="display: grid; grid-template-columns: 1fr 1fr; gap: 40px; max-width: 1200px;">
        <div style="grid-column: 1 / -1;">
            <div class="hero">
                <h1>Start Your Credit Restoration Journey</h1>
                <p>Complete the form below to begin working with our team. We'll review your credit and create a personalized plan of action.</p>
            </div>
            
            <div class="progress-bar">
            <div class="progress-step active" id="step1-indicator">
                <span class="step-number">1</span>
                <span>Personal Info</span>
            </div>
            <div class="progress-step" id="step2-indicator">
                <span class="step-number">2</span>
                <span>Credit Access</span>
            </div>
            <div class="progress-step" id="step3-indicator">
                <span class="step-number">3</span>
                <span>Plan & Payment</span>
            </div>
            <div class="progress-step" id="step4-indicator">
                <span class="step-number">4</span>
                <span>Agreement</span>
            </div>
            </div>
        </div>
        
        <div class="form-card">
            <form id="signupForm">
                <!-- Step 1: Personal Information -->
                <div class="form-section active" id="step1">
                    <h2 class="section-title">Personal Information</h2>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="firstName">First Name <span class="required">*</span></label>
                            <input type="text" id="firstName" name="firstName" required>
                            <span class="error-message">First name is required</span>
                        </div>
                        <div class="form-group">
                            <label for="lastName">Last Name <span class="required">*</span></label>
                            <input type="text" id="lastName" name="lastName" required>
                            <span class="error-message">Last name is required</span>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="email">Email Address <span class="required">*</span></label>
                            <input type="email" id="email" name="email" required>
                            <span class="error-message">Valid email is required</span>
                        </div>
                        <div class="form-group">
                            <label>Phone Number <span class="required">*</span></label>
                            <input type="tel" id="phone" name="phone" placeholder="(xxx) xxx-xxxx" required>
                            <span class="error-message">Phone number is required</span>
                        </div>
                    </div>
                    
                    <div class="form-row single">
                        <div class="form-group">
                            <label for="addressStreet">Street Address <span class="required">*</span></label>
                            <input type="text" id="addressStreet" name="addressStreet" required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="addressCity">City <span class="required">*</span></label>
                            <input type="text" id="addressCity" name="addressCity" required>
                        </div>
                        <div class="form-group">
                            <label>State <span class="required">*</span></label>
                            <select id="addressState" name="addressState" required>
                                <option value="">Select State</option>
                                <option value="AL">Alabama</option>
                                <option value="AK">Alaska</option>
                                <option value="AZ">Arizona</option>
                                <option value="AR">Arkansas</option>
                                <option value="CA">California</option>
                                <option value="CO">Colorado</option>
                                <option value="CT">Connecticut</option>
                                <option value="DE">Delaware</option>
                                <option value="FL">Florida</option>
                                <option value="GA">Georgia</option>
                                <option value="HI">Hawaii</option>
                                <option value="ID">Idaho</option>
                                <option value="IL">Illinois</option>
                                <option value="IN">Indiana</option>
                                <option value="IA">Iowa</option>
                                <option value="KS">Kansas</option>
                                <option value="KY">Kentucky</option>
                                <option value="LA">Louisiana</option>
                                <option value="ME">Maine</option>
                                <option value="MD">Maryland</option>
                                <option value="MA">Massachusetts</option>
                                <option value="MI">Michigan</option>
                                <option value="MN">Minnesota</option>
                                <option value="MS">Mississippi</option>
                                <option value="MO">Missouri</option>
                                <option value="MT">Montana</option>
                                <option value="NE">Nebraska</option>
                                <option value="NV">Nevada</option>
                                <option value="NH">New Hampshire</option>
                                <option value="NJ">New Jersey</option>
                                <option value="NM">New Mexico</option>
                                <option value="NY">New York</option>
                                <option value="NC">North Carolina</option>
                                <option value="ND">North Dakota</option>
                                <option value="OH">Ohio</option>
                                <option value="OK">Oklahoma</option>
                                <option value="OR">Oregon</option>
                                <option value="PA">Pennsylvania</option>
                                <option value="RI">Rhode Island</option>
                                <option value="SC">South Carolina</option>
                                <option value="SD">South Dakota</option>
                                <option value="TN">Tennessee</option>
                                <option value="TX">Texas</option>
                                <option value="UT">Utah</option>
                                <option value="VT">Vermont</option>
                                <option value="VA">Virginia</option>
                                <option value="WA">Washington</option>
                                <option value="WV">West Virginia</option>
                                <option value="WI">Wisconsin</option>
                                <option value="WY">Wyoming</option>
                                <option value="DC">Washington D.C.</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="addressZip">ZIP Code <span class="required">*</span></label>
                            <input type="text" id="addressZip" name="addressZip" pattern="[0-9]{5}" maxlength="5" required>
                        </div>
                        <div class="form-group">
                            <label for="dateOfBirth">Date of Birth <span class="required">*</span></label>
                            <input type="date" id="dateOfBirth" name="dateOfBirth" required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>Last 4 of SSN <span class="required">*</span></label>
                            <input type="text" id="ssnLast4" name="ssnLast4" pattern="[0-9]{4}" maxlength="4" placeholder="XXXX" required>
                            <span class="help-text">Required for credit bureau disputes</span>
                        </div>
                        <div class="form-group">
                            <label>Referral Code</label>
                            <input type="text" id="referralCode" name="referralCode" placeholder="Optional">
                        </div>
                    </div>
                    
                    <div class="button-row">
                        <div></div>
                        <button type="button" class="btn btn-primary" onclick="nextStep(2)">Continue to Credit Access</button>
                    </div>
                </div>
                
                <!-- Step 2: Credit Monitoring Access -->
                <div class="form-section" id="step2">
                    <h2 class="section-title">Credit Monitoring Access</h2>
                    
                    <p style="color: #6b7280; margin-bottom: 25px;">Select your credit monitoring service and provide your login credentials. This allows us to pull your credit report and begin our analysis.</p>
                    
                    <div class="credit-service-grid">
                        <label class="credit-service-option">
                            <input type="radio" name="creditService" value="IdentityIQ.com">
                            <span class="service-name">IdentityIQ.com</span>
                        </label>
                        <label class="credit-service-option">
                            <input type="radio" name="creditService" value="MyScoreIQ.com">
                            <span class="service-name">MyScoreIQ.com</span>
                        </label>
                        <label class="credit-service-option">
                            <input type="radio" name="creditService" value="SmartCredit.com">
                            <span class="service-name">SmartCredit.com</span>
                        </label>
                        <label class="credit-service-option">
                            <input type="radio" name="creditService" value="MyFreeScoreNow.com">
                            <span class="service-name">MyFreeScoreNow.com</span>
                        </label>
                        <label class="credit-service-option">
                            <input type="radio" name="creditService" value="HighScoreNow.com">
                            <span class="service-name">HighScoreNow.com</span>
                        </label>
                        <label class="credit-service-option">
                            <input type="radio" name="creditService" value="IdentityClub.com">
                            <span class="service-name">IdentityClub.com</span>
                        </label>
                        <label class="credit-service-option">
                            <input type="radio" name="creditService" value="PrivacyGuard.com">
                            <span class="service-name">PrivacyGuard.com</span>
                        </label>
                        <label class="credit-service-option">
                            <input type="radio" name="creditService" value="IDClub.com">
                            <span class="service-name">IDClub.com</span>
                        </label>
                        <label class="credit-service-option">
                            <input type="radio" name="creditService" value="MyThreeScores.com">
                            <span class="service-name">MyThreeScores.com</span>
                        </label>
                        <label class="credit-service-option">
                            <input type="radio" name="creditService" value="MyScore750.com">
                            <span class="service-name">MyScore750.com</span>
                        </label>
                        <label class="credit-service-option">
                            <input type="radio" name="creditService" value="Other">
                            <span class="service-name">Other</span>
                        </label>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>Credit Monitoring Username <span class="required">*</span></label>
                            <input type="text" id="creditUsername" name="creditUsername" required>
                        </div>
                        <div class="form-group">
                            <label>Credit Monitoring Password <span class="required">*</span></label>
                            <input type="password" id="creditPassword" name="creditPassword" required>
                            <span class="help-text">Your credentials are encrypted and only used to pull your credit report</span>
                        </div>
                    </div>
                    
                    <div class="button-row">
                        <button type="button" class="btn btn-secondary" onclick="prevStep(1)">Back</button>
                        <button type="button" class="btn btn-primary" onclick="nextStep(3)">Continue to Plan Selection</button>
                    </div>
                </div>
                
                <!-- Step 3: Plan & Payment -->
                <div class="form-section" id="step3">
                    <h2 class="section-title">Choose Your Plan</h2>
                    
                    <p style="color: #6b7280; margin-bottom: 25px;">Select the credit restoration plan that best fits your needs. All plans include FCRA analysis, dispute letter generation, and ongoing support.</p>
                    
                    <div class="pricing-grid" id="pricingGrid">
                        <label class="pricing-option free-tier" data-tier="free" id="freeTierOption">
                            <input type="radio" name="planTier" value="free">
                            <span class="popular-badge" style="background: linear-gradient(135deg, #22d3ee 0%, #06b6d4 100%);">Lead Magnet</span>
                            <div class="plan-header">
                                <span class="plan-name">Basic Analysis</span>
                                <span class="plan-price">FREE</span>
                            </div>
                            <p class="plan-desc">Free credit analysis of negatives only - identify problem areas</p>
                        </label>
                        
                        <label class="pricing-option" data-tier="tier1">
                            <input type="radio" name="planTier" value="tier1">
                            <div class="plan-header">
                                <span class="plan-name">Starter</span>
                                <span class="plan-price">$300</span>
                            </div>
                            <p class="plan-desc">Full FCRA analysis + Round 1 dispute letters</p>
                        </label>
                        
                        <label class="pricing-option" data-tier="tier2">
                            <input type="radio" name="planTier" value="tier2">
                            <div class="plan-header">
                                <span class="plan-name">Standard</span>
                                <span class="plan-price">$600</span>
                            </div>
                            <p class="plan-desc">Full analysis + Rounds 1-2 + violation documentation</p>
                        </label>
                        
                        <label class="pricing-option popular" data-tier="tier3">
                            <input type="radio" name="planTier" value="tier3" checked>
                            <span class="popular-badge">Most Popular</span>
                            <div class="plan-header">
                                <span class="plan-name">Premium</span>
                                <span class="plan-price">$900</span>
                            </div>
                            <p class="plan-desc">Litigation-ready: Rounds 1-3 + willfulness + damages calc</p>
                        </label>
                        
                        <label class="pricing-option" data-tier="tier4">
                            <input type="radio" name="planTier" value="tier4">
                            <div class="plan-header">
                                <span class="plan-name">Professional</span>
                                <span class="plan-price">$1,200</span>
                            </div>
                            <p class="plan-desc">Full litigation package: All 4 rounds + settlement demand</p>
                        </label>
                        
                        <label class="pricing-option" data-tier="tier5">
                            <input type="radio" name="planTier" value="tier5">
                            <div class="plan-header">
                                <span class="plan-name">Elite</span>
                                <span class="plan-price">$1,500</span>
                            </div>
                            <p class="plan-desc">Maximum recovery: Attorney coordination + VIP support</p>
                        </label>
                    </div>
                    
                    <div class="payment-methods" id="paymentMethodsSection">
                        <div class="payment-methods-title">Select Payment Method</div>
                        <div class="payment-methods-grid">
                            <label class="payment-option selected" data-method="stripe">
                                <input type="radio" name="paymentMethod" value="stripe" checked>
                                <div class="payment-icon">üí≥</div>
                                <div class="payment-name">Credit/Debit Card</div>
                            </label>
                            <label class="payment-option" data-method="paypal" id="paypalOption">
                                <input type="radio" name="paymentMethod" value="paypal">
                                <div class="payment-icon">üÖøÔ∏è</div>
                                <div class="payment-name">PayPal</div>
                            </label>
                            <label class="payment-option" data-method="cashapp" id="cashappOption">
                                <input type="radio" name="paymentMethod" value="cashapp">
                                <div class="payment-icon">üíµ</div>
                                <div class="payment-name">Cash App</div>
                            </label>
                            <label class="payment-option" data-method="venmo" id="venmoOption">
                                <input type="radio" name="paymentMethod" value="venmo">
                                <div class="payment-icon">üì±</div>
                                <div class="payment-name">Venmo</div>
                            </label>
                            <label class="payment-option" data-method="zelle" id="zelleOption">
                                <input type="radio" name="paymentMethod" value="zelle">
                                <div class="payment-icon">üè¶</div>
                                <div class="payment-name">Zelle</div>
                            </label>
                            <label class="payment-option" data-method="paylater" id="paylaterOption">
                                <input type="radio" name="paymentMethod" value="paylater">
                                <div class="payment-icon">‚è±Ô∏è</div>
                                <div class="payment-name">Pay Later</div>
                            </label>
                        </div>
                        
                        <div class="manual-payment-info" id="cashappInfo">
                            <h4>Send Payment via Cash App</h4>
                            <div class="payment-handle" id="cashappHandle">$cashtag</div>
                            <p>Send <strong id="cashappAmount">$0</strong> to the Cash App above, then complete your signup. We'll confirm your payment manually.</p>
                        </div>
                        
                        <div class="manual-payment-info" id="venmoInfo">
                            <h4>Send Payment via Venmo</h4>
                            <div class="payment-handle" id="venmoHandle">@username</div>
                            <p>Send <strong id="venmoAmount">$0</strong> to the Venmo above, then complete your signup. We'll confirm your payment manually.</p>
                        </div>
                        
                        <div class="manual-payment-info" id="zelleInfo">
                            <h4>Send Payment via Zelle</h4>
                            <div class="payment-handle" id="zelleHandle">email@example.com</div>
                            <p>Send <strong id="zelleAmount">$0</strong> to the Zelle above, then complete your signup. We'll confirm your payment manually.</p>
                        </div>
                        
                        <div class="manual-payment-info" id="paypalInfo">
                            <h4>Send Payment via PayPal</h4>
                            <div class="payment-handle" id="paypalHandle">email@paypal.com</div>
                            <p>Send <strong id="paypalAmount">$0</strong> to the PayPal above, then complete your signup. We'll confirm your payment manually.</p>
                        </div>
                        
                        <div class="pay-later-info" id="paylaterInfo">
                            <h4>Pay Later</h4>
                            <p>You can complete your signup now and pay later. We'll contact you to arrange payment before starting your case.</p>
                        </div>
                    </div>
                    
                    <div class="plan-features">
                        <h4>All plans include:</h4>
                        <ul>
                            <li>Comprehensive FCRA violation analysis</li>
                            <li>Professional dispute letter generation</li>
                            <li>Direct communication with credit bureaus</li>
                            <li>Progress tracking via client portal</li>
                            <li>Expert guidance throughout the process</li>
                        </ul>
                    </div>
                    
                    <div class="button-row">
                        <button type="button" class="btn btn-secondary" onclick="prevStep(2)">Back</button>
                        <button type="button" class="btn btn-primary" onclick="nextStep(4)">Continue to Agreement</button>
                    </div>
                </div>
                
                <!-- Step 4: Service Agreement -->
                <div class="form-section" id="step4">
                    <h2 class="section-title">Service Agreement</h2>
                    
                    <div class="agreement-section">
                        <h3>Credit Repair Organization Authorization</h3>
                        <div class="agreement-text">
                            <p><strong>AUTHORIZATION AND AGREEMENT</strong></p>
                            <p style="margin-top: 10px;">By signing this agreement, you authorize Brightpath Ascend Group to act on your behalf in disputing inaccurate, misleading, or unverifiable information on your credit reports with the three major credit bureaus: Equifax, Experian, and TransUnion.</p>
                            
                            <p style="margin-top: 15px;"><strong>1. Services Provided</strong></p>
                            <p>We will review your credit reports, identify potentially disputable items, prepare and send dispute letters to credit bureaus and/or creditors, track responses, and provide ongoing guidance throughout the credit restoration process.</p>
                            
                            <p style="margin-top: 15px;"><strong>2. Your Rights Under FCRA</strong></p>
                            <p>You have the right to dispute inaccurate information in your credit report by contacting the credit bureau directly for free. You are entitled to a free credit report annually from each of the three major bureaus at www.annualcreditreport.com.</p>
                            
                            <p style="margin-top: 15px;"><strong>3. No Guarantees</strong></p>
                            <p>We do not guarantee specific results. The outcome of disputes depends on the accuracy and completeness of information provided by creditors and credit bureaus.</p>
                            
                            <p style="margin-top: 15px;"><strong>4. Cancellation Policy</strong></p>
                            <p>You may cancel this agreement at any time by providing written notice. You will not be charged for services not yet performed.</p>
                            
                            <p style="margin-top: 15px;"><strong>5. Privacy Policy</strong></p>
                            <p>Your personal information will be kept confidential and used only for the purpose of providing credit repair services. We will not sell or share your information with third parties except as necessary to perform our services.</p>
                        </div>
                        
                        <div class="checkbox-group">
                            <input type="checkbox" id="agreeTerms" name="agreeTerms" required>
                            <label for="agreeTerms">I have read, understand, and agree to the terms and conditions of this service agreement. I authorize Brightpath Ascend Group to act on my behalf.</label>
                        </div>
                    </div>
                    
                    <div class="checkbox-group" style="margin-bottom: 20px;">
                        <input type="checkbox" id="agreeComms" name="agreeComms">
                        <label for="agreeComms">I agree to receive email and SMS communications about my case status (optional)</label>
                    </div>
                    
                    <div class="button-row">
                        <button type="button" class="btn btn-secondary" onclick="prevStep(3)">Back</button>
                        <button type="submit" class="btn btn-primary" id="submitBtn">
                            <span class="loading-spinner" id="loadingSpinner"></span>
                            Proceed to Payment
                        </button>
                    </div>
                </div>
                
                <!-- Success Message -->
                <div class="success-message" id="successMessage">
                    <div class="success-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                        </svg>
                    </div>
                    <h2>Welcome to Brightpath Ascend Group!</h2>
                    <p>Your registration is complete. We'll pull your credit report and send your personalized credit analysis within 24-48 hours.</p>
                    
                    <div class="referral-code">
                        <label>Your Referral Code</label>
                        <div class="code" id="clientReferralCode">-</div>
                        <p style="font-size: 12px; color: #6b7280; margin-top: 5px;">Share this code with friends and family</p>
                    </div>
                    
                    <a href="/portal" class="btn btn-primary" style="display: inline-block; text-decoration: none;">Go to Client Portal</a>
                </div>
            </form>
        </div>
        
        <!-- Sample Analysis Panel -->
        <div class="sample-section">
            <div class="sample-card">
                <div class="sample-title">üìä Sample Analysis</div>
                <p style="color: rgba(255,255,255,0.6); font-size: 13px; margin-bottom: 20px;">See what your credit analysis could reveal</p>
                
                <div style="margin-bottom: 20px;">
                    <div class="sample-title" style="margin-bottom: 12px;">Violations Detected</div>
                    <div class="violation-item">
                        <div class="violation-type">FCRA ¬ß 611 Dispute</div>
                        <div class="violation-desc">Response period exceeded - Bureau failed to respond within 30 days</div>
                    </div>
                    <div class="violation-item">
                        <div class="violation-type">FCRA ¬ß 623 Furnisher</div>
                        <div class="violation-desc">Account marked late despite payment verification</div>
                    </div>
                    <div class="violation-item">
                        <div class="violation-type">FDCPA Collector</div>
                        <div class="violation-desc">Collection account on credit report - potential statute of limitations</div>
                    </div>
                </div>
            </div>
            
            <div class="sample-card">
                <div class="sample-title">üí∞ Potential Damages</div>
                <div class="damages-grid">
                    <div class="damage-box">
                        <div class="damage-label">Statutory</div>
                        <div class="damage-amount">$3,000</div>
                    </div>
                    <div class="damage-box">
                        <div class="damage-label">Actual</div>
                        <div class="damage-amount">$850</div>
                    </div>
                </div>
                <div style="margin-top: 12px; padding: 12px; background: rgba(255,255,255,0.05); border-radius: 8px; text-align: center;">
                    <div class="damage-label">Punitive (if willful)</div>
                    <div class="damage-amount" style="color: #f97316;">$2,500</div>
                </div>
            </div>
            
            <div class="estimate-box">
                <div class="estimate-label">ESTIMATED CASE VALUE</div>
                <div class="estimate-amount">$6,350</div>
                <div class="estimate-note">Based on 3+ violations with willful conduct</div>
            </div>
            
            <div class="sample-card" style="background: rgba(34, 197, 94, 0.08); border-color: rgba(34, 197, 94, 0.3);">
                <div style="color: #86efac; font-size: 12px; line-height: 1.6;">
                    <strong style="display: block; margin-bottom: 8px;">‚úì Disputed Items: 3</strong>
                    <strong style="display: block; margin-bottom: 8px;">‚úì Reinsertion Risk: High</strong>
                    <strong>‚úì Timeline: 60-90 days</strong>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Payment settings loaded from server
        let paymentSettings = {
            payment_stripe_enabled: true,
            payment_paypal_enabled: false,
            payment_cashapp_enabled: false,
            payment_venmo_enabled: false,
            payment_zelle_enabled: false,
            allow_pay_later: true,
            payment_cashapp: '',
            payment_venmo: '',
            payment_zelle: '',
            payment_paypal: '',
            tier_free_enabled: true
        };
        
        const tierPrices = {
            'free': 0,
            'tier1': 300,
            'tier2': 600,
            'tier3': 900,
            'tier4': 1200,
            'tier5': 1500
        };
        
        // Load settings from server
        async function loadPaymentSettings() {
            try {
                const response = await fetch('/api/settings/get');
                const result = await response.json();
                if (result.success && result.settings) {
                    paymentSettings = { ...paymentSettings, ...result.settings };
                    updatePaymentMethodsVisibility();
                    updateFreeTierVisibility();
                }
            } catch (e) {
                console.log('Using default settings');
            }
        }
        
        function updateFreeTierVisibility() {
            const freeTierOption = document.getElementById('freeTierOption');
            if (freeTierOption) {
                freeTierOption.style.display = paymentSettings.tier_free_enabled ? '' : 'none';
            }
        }
        
        function updatePaymentMethodsVisibility() {
            if (paymentSettings.payment_stripe_enabled) {
                document.querySelector('[data-method="stripe"]').style.display = '';
            }
            if (paymentSettings.payment_paypal_enabled) {
                document.getElementById('paypalOption').style.display = '';
                document.getElementById('paypalHandle').textContent = paymentSettings.payment_paypal || 'Not configured';
            }
            if (paymentSettings.payment_cashapp_enabled) {
                document.getElementById('cashappOption').style.display = '';
                document.getElementById('cashappHandle').textContent = paymentSettings.payment_cashapp || 'Not configured';
            }
            if (paymentSettings.payment_venmo_enabled) {
                document.getElementById('venmoOption').style.display = '';
                document.getElementById('venmoHandle').textContent = paymentSettings.payment_venmo || 'Not configured';
            }
            if (paymentSettings.payment_zelle_enabled) {
                document.getElementById('zelleOption').style.display = '';
                document.getElementById('zelleHandle').textContent = paymentSettings.payment_zelle || 'Not configured';
            }
            if (paymentSettings.allow_pay_later) {
                document.getElementById('paylaterOption').style.display = '';
            }
        }
        
        function updatePaymentAmounts() {
            const selectedPlan = document.querySelector('input[name="planTier"]:checked');
            if (!selectedPlan) return;
            
            const price = tierPrices[selectedPlan.value] || 0;
            const priceFormatted = '$' + price;
            
            document.getElementById('cashappAmount').textContent = priceFormatted;
            document.getElementById('venmoAmount').textContent = priceFormatted;
            document.getElementById('zelleAmount').textContent = priceFormatted;
            document.getElementById('paypalAmount').textContent = priceFormatted;
        }
        
        function hideAllPaymentInfos() {
            document.querySelectorAll('.manual-payment-info, .pay-later-info').forEach(el => {
                el.classList.remove('active');
            });
        }
        
        function showPaymentInfo(method) {
            hideAllPaymentInfos();
            const infoEl = document.getElementById(method + 'Info');
            if (infoEl) {
                infoEl.classList.add('active');
            }
        }
        
        // Initialize credit service selection
        document.querySelectorAll('.credit-service-option').forEach(option => {
            option.addEventListener('click', function() {
                document.querySelectorAll('.credit-service-option').forEach(o => o.classList.remove('selected'));
                this.classList.add('selected');
                this.querySelector('input').checked = true;
            });
        });
        
        // Initialize pricing tier selection
        document.querySelectorAll('.pricing-option').forEach(option => {
            option.addEventListener('click', function() {
                document.querySelectorAll('.pricing-option').forEach(o => o.classList.remove('selected'));
                this.classList.add('selected');
                this.querySelector('input').checked = true;
                
                // Check if free tier selected - hide payment methods
                const selectedValue = this.querySelector('input').value;
                const paymentSection = document.getElementById('paymentMethodsSection');
                if (selectedValue === 'free') {
                    paymentSection.style.display = 'none';
                } else {
                    paymentSection.style.display = '';
                    updatePaymentAmounts();
                }
            });
            // Set initial selected state for tier3 (Premium)
            if (option.querySelector('input').checked) {
                option.classList.add('selected');
            }
        });
        
        // Initialize payment method selection
        document.querySelectorAll('.payment-option').forEach(option => {
            option.addEventListener('click', function() {
                document.querySelectorAll('.payment-option').forEach(o => o.classList.remove('selected'));
                this.classList.add('selected');
                this.querySelector('input').checked = true;
                
                const method = this.dataset.method;
                if (['cashapp', 'venmo', 'zelle', 'paypal', 'paylater'].includes(method)) {
                    showPaymentInfo(method);
                } else {
                    hideAllPaymentInfos();
                }
            });
        });
        
        // Load settings on page load
        loadPaymentSettings();
        
        // Phone number formatting
        document.getElementById('phone').addEventListener('input', function(e) {
            let x = e.target.value.replace(/\D/g, '').match(/(\d{0,3})(\d{0,3})(\d{0,4})/);
            e.target.value = !x[2] ? x[1] : '(' + x[1] + ') ' + x[2] + (x[3] ? '-' + x[3] : '');
        });
        
        function validateStep(step) {
            let valid = true;
            const section = document.getElementById('step' + step);
            const inputs = section.querySelectorAll('input[required], select[required]');
            
            inputs.forEach(input => {
                if (!input.value.trim()) {
                    input.classList.add('error');
                    valid = false;
                } else {
                    input.classList.remove('error');
                }
            });
            
            // Step 2: Check credit service selection
            if (step === 2) {
                const serviceSelected = document.querySelector('input[name="creditService"]:checked');
                if (!serviceSelected) {
                    alert('Please select a credit monitoring service');
                    valid = false;
                }
            }
            
            // Step 3: Check plan selection
            if (step === 3) {
                const planSelected = document.querySelector('input[name="planTier"]:checked');
                if (!planSelected) {
                    alert('Please select a pricing plan');
                    valid = false;
                }
            }
            
            // Step 4: Check agreement
            if (step === 4) {
                if (!document.getElementById('agreeTerms').checked) {
                    alert('Please agree to the terms and conditions to continue');
                    valid = false;
                }
            }
            
            return valid;
        }
        
        function nextStep(step) {
            if (!validateStep(step - 1)) return;
            
            // Update progress indicators
            document.getElementById('step' + (step - 1) + '-indicator').classList.remove('active');
            document.getElementById('step' + (step - 1) + '-indicator').classList.add('completed');
            document.getElementById('step' + step + '-indicator').classList.add('active');
            
            // Show new section
            document.getElementById('step' + (step - 1)).classList.remove('active');
            document.getElementById('step' + step).classList.add('active');
            
            window.scrollTo(0, 0);
        }
        
        function prevStep(step) {
            const currentStep = step + 1;
            
            // Update progress indicators
            document.getElementById('step' + currentStep + '-indicator').classList.remove('active');
            document.getElementById('step' + step + '-indicator').classList.remove('completed');
            document.getElementById('step' + step + '-indicator').classList.add('active');
            
            // Show previous section
            document.getElementById('step' + currentStep).classList.remove('active');
            document.getElementById('step' + step).classList.add('active');
            
            window.scrollTo(0, 0);
        }
        
        document.getElementById('signupForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            if (!validateStep(4)) return;
            
            const submitBtn = document.getElementById('submitBtn');
            const spinner = document.getElementById('loadingSpinner');
            
            submitBtn.disabled = true;
            spinner.style.display = 'inline-block';
            
            const selectedPlan = document.querySelector('input[name="planTier"]:checked').value;
            const selectedPaymentMethod = document.querySelector('input[name="paymentMethod"]:checked')?.value || 'stripe';
            
            const formData = {
                firstName: document.getElementById('firstName').value,
                lastName: document.getElementById('lastName').value,
                email: document.getElementById('email').value,
                phone: document.getElementById('phone').value,
                addressStreet: document.getElementById('addressStreet').value,
                addressCity: document.getElementById('addressCity').value,
                addressState: document.getElementById('addressState').value,
                addressZip: document.getElementById('addressZip').value,
                dateOfBirth: document.getElementById('dateOfBirth').value,
                ssnLast4: document.getElementById('ssnLast4').value,
                referralCode: document.getElementById('referralCode').value,
                creditService: document.querySelector('input[name="creditService"]:checked')?.value || '',
                creditUsername: document.getElementById('creditUsername').value,
                creditPassword: document.getElementById('creditPassword').value,
                planTier: selectedPlan,
                paymentMethod: selectedPlan === 'free' ? 'free' : selectedPaymentMethod,
                agreeTerms: document.getElementById('agreeTerms').checked,
                agreeComms: document.getElementById('agreeComms').checked
            };
            
            try {
                // Step 1: Create signup draft
                const draftResponse = await fetch('/api/client/signup/draft', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(formData)
                });
                
                const draftResult = await draftResponse.json();
                
                if (!draftResult.success) {
                    alert('Error: ' + (draftResult.error || 'Failed to save your information'));
                    submitBtn.disabled = false;
                    spinner.style.display = 'none';
                    return;
                }
                
                // Handle different payment flows
                if (selectedPlan === 'free') {
                    // Free tier - complete immediately
                    const completeResponse = await fetch('/api/client/signup/complete-free', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ draftId: draftResult.draftId })
                    });
                    
                    const completeResult = await completeResponse.json();
                    
                    if (completeResult.success) {
                        showSuccessMessage(completeResult.referralCode, false, completeResult.passwordResetToken);
                    } else {
                        alert('Error: ' + (completeResult.error || 'Failed to complete signup'));
                        submitBtn.disabled = false;
                        spinner.style.display = 'none';
                    }
                } else if (['cashapp', 'venmo', 'zelle', 'paypal', 'paylater'].includes(selectedPaymentMethod)) {
                    // Manual payment - complete with pending status
                    const completeResponse = await fetch('/api/client/signup/complete-manual', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ 
                            draftId: draftResult.draftId,
                            paymentMethod: selectedPaymentMethod
                        })
                    });
                    
                    const completeResult = await completeResponse.json();
                    
                    if (completeResult.success) {
                        showSuccessMessage(completeResult.referralCode, true, completeResult.passwordResetToken);
                    } else {
                        alert('Error: ' + (completeResult.error || 'Failed to complete signup'));
                        submitBtn.disabled = false;
                        spinner.style.display = 'none';
                    }
                } else {
                    // Stripe payment - redirect to checkout
                    const checkoutResponse = await fetch('/api/stripe/checkout-session', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ draftId: draftResult.draftId })
                    });
                    
                    const checkoutResult = await checkoutResponse.json();
                    
                    if (checkoutResult.success && checkoutResult.checkoutUrl) {
                        window.location.href = checkoutResult.checkoutUrl;
                    } else {
                        alert('Error: ' + (checkoutResult.error || 'Failed to create payment session'));
                        submitBtn.disabled = false;
                        spinner.style.display = 'none';
                    }
                }
            } catch (error) {
                console.error('Signup error:', error);
                alert('Connection error. Please try again.');
                submitBtn.disabled = false;
                spinner.style.display = 'none';
            }
        });
        
        function showSuccessMessage(referralCode, isPending = false, passwordResetToken = null) {
            // Redirect to the welcome page instead of showing inline success
            let welcomeUrl = '/signup/welcome';
            let params = [];
            if (referralCode) {
                params.push('ref=' + encodeURIComponent(referralCode));
            }
            if (isPending) {
                params.push('pending=true');
            }
            if (passwordResetToken) {
                params.push('token=' + encodeURIComponent(passwordResetToken));
            }
            if (params.length > 0) {
                welcomeUrl += '?' + params.join('&');
            }
            window.location.href = welcomeUrl;
        }
        
        // Handle success/cancel from URL params
        const urlParams = new URLSearchParams(window.location.search);
        if (urlParams.get('cancelled') === 'true') {
            alert('Payment was cancelled. You can try again when ready.');
        }
        
        // Check for success state passed from server - redirect to welcome page
        {% if success %}
            let welcomeUrl = '/signup/welcome';
            {% if referral_code %}
                welcomeUrl += '?ref={{ referral_code }}';
            {% endif %}
            {% if pending %}
                welcomeUrl += '{{ "?pending=true" if not referral_code else "&pending=true" }}';
            {% endif %}
            window.location.href = welcomeUrl;
        {% endif %}
    </script>
</body>
</html>
